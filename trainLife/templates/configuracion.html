<!DOCTYPE html>
<html lang="es">
    {% load static %}
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuración - TrainLife</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{% static 'styles/configuracion.css' %}">
    <link rel="stylesheet" href="{% static 'styles/sidebar.css' %}">
    <link rel="stylesheet" href="{% static 'styles/confirmModal.css' %}">
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body>
    <div class="dashboard-container">
        <!-- Mobile Menu Toggle -->
        <button class="mobile-menu-toggle" aria-label="Toggle menu">
            <i data-lucide="menu"></i>
        </button>

        <!-- Sidebar -->
        {% with seccion_actual='configuracion' %}
            {% include 'includes/sidebar.html' %}
        {% endwith %}

        <!-- Mensajes de Django -->
        {% if messages %}
            <div class="django-messages" style="display: none;">
                {% for message in messages %}
                    <div class="alert alert-{{ message.tags }}">
                        {{ message }}
                    </div>
                {% endfor %}
            </div>
        {% endif %}

        <!-- Main Content -->
        <main class="main-content">
            <div class="content-wrapper">
                <!-- Breadcrumbs -->
                <nav class="breadcrumbs" aria-label="Breadcrumb">
                    <a href="{% url 'inicio_usuario' usuario.id %}" class="breadcrumb-link">Home</a>
                    <span class="breadcrumb-separator">/</span>
                    <span class="breadcrumb-current">Configuración</span>
                </nav>

                <!-- Page Title -->
                <h1 class="page-title">Configuración</h1>

                <!-- Personal Information Section -->
                <h2 class="section-title">Información Personal</h2>
                <p class="section-subtitle">
                    Aquí puedes ver y actualizar tu información personal.
                </p>

                <!-- Form Card -->
                <div class="form-card">
                    <form id="personalInfoForm" method="POST" action="{% url 'configuracion' usuario.id %}" aria-label="Formulario de información personal">
                        {% csrf_token %}
                        <!-- Nombre -->
                        <div class="form-group">
                            <label for="nombre" class="form-label">Nombre</label>
                            <div class="input-wrapper">
                                <input
                                    type="text"
                                    id="nombre"
                                    name="nombreUsuario"
                                    class="form-input"
                                    value="{{ usuario.nombreUsuario }}"
                                    aria-required="true"
                                />
                                <i data-lucide="edit" class="input-icon"></i>
                            </div>
                        </div>

                        <!-- Apellidos Row -->
                        <div class="form-row">
                            <div class="form-group">
                                <label for="primerApellido" class="form-label">Primer Apellido</label>
                                <div class="input-wrapper">
                                    <input
                                        type="text"
                                        id="primerApellido"
                                        name="apellido1"
                                        class="form-input"
                                        value="{{ usuario.apellido1 }}"
                                        aria-required="true"
                                    />
                                    <i data-lucide="edit" class="input-icon"></i>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="segundoApellido" class="form-label">Segundo Apellido</label>
                                <div class="input-wrapper">
                                    <input
                                        type="text"
                                        id="segundoApellido"
                                        name="apellido2"
                                        class="form-input"
                                        value="{{ usuario.apellido2|default:'' }}"
                                    />
                                    <i data-lucide="edit" class="input-icon"></i>
                                </div>
                            </div>
                        </div>

                        <!-- Contact Info Row -->
                        <div class="form-row">
                            <div class="form-group">
                                <label for="telefono" class="form-label">Número de Teléfono</label>
                                <div class="input-wrapper">
                                    <input
                                        type="tel"
                                        id="telefono"
                                        name="numeroTelefono"
                                        class="form-input"
                                        value="{{ usuario.numeroTelefono|default:'' }}"
                                        aria-required="true"
                                    />
                                    <i data-lucide="edit" class="input-icon"></i>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="email" class="form-label">Correo Electrónico</label>
                                <div class="input-wrapper">
                                    <input
                                        type="email"
                                        id="email"
                                        name="email"
                                        class="form-input"
                                        value="{{ usuario.email }}"
                                        aria-required="true"
                                    />
                                    <i data-lucide="edit" class="input-icon"></i>
                                </div>
                            </div>
                        </div>
                </div>

                <!-- Notifications Section -->
                <h2 class="section-title section-title-spaced">Configuración de Notificaciones</h2>
                <p class="section-subtitle">
                    Gestiona cómo y cuándo te notificamos sobre tus viajes y la aplicación.
                </p>

                <!-- Info Banner -->
                <div class="info-banner" role="note" aria-label="Información sobre notificaciones">
                    <i data-lucide="info" class="info-icon"></i>
                    <p class="info-text">
                        Para una mejor experiencia, te recomendamos mantener las notificaciones activas. Así
                        recibirás información importante sobre tus viajes en tiempo real.
                    </p>
                </div>

                <!-- Settings Card -->
                <div class="settings-card" role="group" aria-labelledby="notif-viajes-rutas">
                    <h3 class="settings-heading" id="notif-viajes-rutas">
                        Notificaciones de Viajes y Rutas
                    </h3>

                    <!-- Toggle 1 -->
                    <div class="toggle-item">
                        <div class="toggle-content">
                            <label for="travelToggle" class="toggle-label" id="travel-label">
                                Modificaciones en mis viajes
                            </label>
                            <p class="toggle-description">
                                Recibe alertas sobre cambios, retrasos o cancelaciones.
                            </p>
                        </div>
                        <div class="toggle-switch-wrapper">
                            <input
                                type="checkbox"
                                id="travelToggle"
                                name="notificacionesViajes"
                                class="toggle-input"
                                role="switch"
                                aria-checked="{{ usuario.notificacionesViajes|yesno:'true,false' }}"
                                aria-labelledby="travel-label"
                                {% if usuario.notificacionesViajes %}checked{% endif %}
                            />
                            <div class="toggle-switch">
                                <div class="toggle-slider"></div>
                            </div>
                        </div>
                    </div>

                    <div class="settings-divider"></div>

                    <!-- Toggle 2 -->
                    <div class="toggle-item">
                        <div class="toggle-content">
                            <label for="routeToggle" class="toggle-label">
                                Modificaciones en mis rutas
                            </label>
                            <p class="toggle-description">
                                Notificaciones sobre cambios en tus rutas guardadas.
                            </p>
                        </div>
                        <div class="toggle-switch-wrapper">
                            <input
                                type="checkbox"
                                id="routeToggle"
                                name="notificacionesRutas"
                                class="toggle-input"
                                {% if usuario.notificacionesRutas %}checked{% endif %}
                            />
                            <div class="toggle-switch">
                                <div class="toggle-slider"></div>
                            </div>
                        </div>
                    </div>

                    <div class="settings-divider"></div>

                    <h3 class="settings-heading">Notificaciones Generales</h3>

                    <!-- Toggle 3 -->
                    <div class="toggle-item">
                        <div class="toggle-content">
                            <label for="generalToggle" class="toggle-label">
                                Avisos generales de TrainLife
                            </label>
                            <p class="toggle-description">
                                Promociones, noticias y actualizaciones de la app.
                            </p>
                        </div>
                        <div class="toggle-switch-wrapper">
                            <input
                                type="checkbox"
                                id="generalToggle"
                                name="notificacionesAvisos"
                                class="toggle-input"
                                {% if usuario.notificacionesAvisos %}checked{% endif %}
                            />
                            <div class="toggle-switch">
                                <div class="toggle-slider"></div>
                            </div>
                        </div>
                    </div>
                </div>
                    </form>

                <!-- Save Button -->
                <div class="button-container">
                    <button
                        type="submit"
                        form="personalInfoForm"
                        id="saveBtn"
                        class="save-btn"
                        aria-label="Guardar todos los cambios realizados en la configuración"
                    >
                        Guardar Cambios
                    </button>
                </div>
            </div>
        </main>
    </div>

    <!-- Bootstrap Bundle JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JavaScript -->
    <script src="{% static 'js/confirmModal.js' %}"></script>
    <script src="{% static 'js/sidebar.js' %}"></script>
    <script src="{% static 'js/configuracion.js' %}"></script>
</body>
</html>
